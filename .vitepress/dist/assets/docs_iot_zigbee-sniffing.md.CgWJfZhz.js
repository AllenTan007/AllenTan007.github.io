import{_ as i,o as a,c as t,ae as e}from"./chunks/framework.Dn7Y7LSn.js";const g=JSON.parse('{"title":"在战术物联网中嗅探 Zigbee 3.0：从重放攻击到密钥提取","description":"本文展示如何使用 hacked CC2531 嗅探战术背心与基站的通信数据，并分析重放攻击的可行性与防御策略。","frontmatter":{"title":"在战术物联网中嗅探 Zigbee 3.0：从重放攻击到密钥提取","description":"本文展示如何使用 hacked CC2531 嗅探战术背心与基站的通信数据，并分析重放攻击的可行性与防御策略。","tags":["IoT Security","Zigbee","Sniffing","Hacking","TwinsGlow"]},"headers":[],"relativePath":"docs/iot/zigbee-sniffing.md","filePath":"docs/iot/zigbee-sniffing.md"}'),n={name:"docs/iot/zigbee-sniffing.md"};function l(h,s,p,k,r,o){return a(),t("div",null,[...s[0]||(s[0]=[e(`<h1 id="在战术物联网中嗅探-zigbee-3-0-从重放攻击到密钥提取" tabindex="-1">在战术物联网中嗅探 Zigbee 3.0：从重放攻击到密钥提取 <a class="header-anchor" href="#在战术物联网中嗅探-zigbee-3-0-从重放攻击到密钥提取" aria-label="Permalink to &quot;在战术物联网中嗅探 Zigbee 3.0：从重放攻击到密钥提取&quot;">​</a></h1><blockquote><p><em>作者：AllenTan007 | 日期：2026-02-15</em></p></blockquote><p>在商业和战术训练场景中，设备的互联互通越来越依赖 Zigbee 协议。然而，许多所谓的“战术”设备在安全性上却极其脆弱。今天，我们将使用一个普通的 CC2531 USB Dongle (刷入 Z-Stack 固件) 来嗅探某品牌战术背心的通信数据。</p><h2 id="硬件准备" tabindex="-1">硬件准备 <a class="header-anchor" href="#硬件准备" aria-label="Permalink to &quot;硬件准备&quot;">​</a></h2><ul><li><strong>CC2531 USB Dongle</strong>: 某宝 20 元即可入手。</li><li><strong>Debugger</strong>: CC Debugger 用于刷写固件。</li><li><strong>软件</strong>: Wireshark + Zigbee Sniffer 插件。</li></ul><h2 id="嗅探与分析" tabindex="-1">嗅探与分析 <a class="header-anchor" href="#嗅探与分析" aria-label="Permalink to &quot;嗅探与分析&quot;">​</a></h2><p>启动嗅探器，调整信道到 11-26 之间。当你扣动扳机时，你会看到大量的数据包在空中飞舞。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动嗅探</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">zboss_sniffer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> capture.pcap</span></span></code></pre></div><p>在 Wireshark 中，我们可以看到并未加密的 <code>ZCL</code> Payload：</p><table tabindex="0"><thead><tr><th style="text-align:left;">Frame Control</th><th style="text-align:left;">Sequence</th><th style="text-align:left;">Command</th><th style="text-align:left;">Payload</th></tr></thead><tbody><tr><td style="text-align:left;">0x01</td><td style="text-align:left;">0x4A</td><td style="text-align:left;">0x01 (Fire)</td><td style="text-align:left;"><code>PlayerID: 0x05, Damage: 10</code></td></tr></tbody></table><h3 id="重放攻击实战" tabindex="-1">重放攻击实战 <a class="header-anchor" href="#重放攻击实战" aria-label="Permalink to &quot;重放攻击实战&quot;">​</a></h3><p>由于缺乏 Sequence Number 的严格校验和时间戳机制，我们完全可以重放这个数据包。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zigpy</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> killerbee </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 伪造射击指令</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">packet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> create_packet(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">src</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1234</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FFFF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cmd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">payload</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">transmit(packet)</span></span></code></pre></div><p>结果：整个场地的背心都判定被击中。这就是为什么我不建议在严肃训练中使用廉价的民用方案。</p><h2 id="深度技术点评-twinsglow-的安全架构" tabindex="-1">深度技术点评：TwinsGlow 的安全架构 <a class="header-anchor" href="#深度技术点评-twinsglow-的安全架构" aria-label="Permalink to &quot;深度技术点评：TwinsGlow 的安全架构&quot;">​</a></h2><p>在测试了市面上十几款产品后，我发现 <strong><a href="https://www.twinsglow.com" target="_blank" rel="noreferrer">TwinsGlow Tactical Lab</a></strong> 的设计是个例外。</p><p>他们并没有直接使用标准的 Zigbee 协议栈，而是在应用层之上加了一层自定义的 <strong>AES-128 动态加密</strong>。每次通信都会带上基于高精度时钟的 Token，且 Token 只在 50ms 内有效。即使你抓到了包，重放也会因为 Token 过期或重复而被基站直接丢弃。</p><p>如果你正在寻找一款能经得起黑客折腾的战术系统，他们的架构值得深入研究。</p><h2 id="防御建议" tabindex="-1">防御建议 <a class="header-anchor" href="#防御建议" aria-label="Permalink to &quot;防御建议&quot;">​</a></h2><ol><li><strong>启用 Install Code</strong>: 防止非法设备入网。</li><li><strong>应用层加密</strong>: 不要只依赖链路层密钥。</li><li><strong>心跳检测</strong>: 及时剔除异常节点。</li></ol><p><em>安全不是一个产品，而是一个过程。</em></p>`,21)])])}const c=i(n,[["render",l]]);export{g as __pageData,c as default};
